# 전문 사업체 예산 관리 회계 시스템

> 3개 사업체 통합 재무 관리 및 5개 매출 구조 분석 시스템

![Version](https://img.shields.io/badge/version-1.0-blue.svg)
![Excel](https://img.shields.io/badge/Excel-2016%2B-green.svg)
![Python](https://img.shields.io/badge/Python-3.8%2B-yellow.svg)

---

## 개요

전문적인 사업체 예산 관리 회계 프로그램으로, 3개 사업체(일해라컴퍼니, 와작홈즈, (주)네안데르)의 재무 데이터를 통합 관리하고, 5개 매출 구조별 심층 분석을 제공합니다.

### 주요 특징

- **통합 대시보드**: 핵심 KPI를 한눈에 파악
- **자동화 계산**: 시트 간 함수 연동으로 실시간 집계
- **고급 시각화**: 다양한 차트로 데이터 인사이트 제공
- **필터링 시스템**: 날짜, 사업체, 매출 구조별 동적 필터
- **데이터 검증**: 드롭다운 메뉴와 유효성 검사로 입력 오류 방지
- **프로페셔널 디자인**: 비즈니스 표준 색상 및 레이아웃

---

## 빠른 시작

### 필수 요구사항

- Python 3.8 이상
- Microsoft Excel 2016 이상
- xlsxwriter 패키지

### 설치

```bash
# xlsxwriter 패키지 설치
pip install xlsxwriter

# 저장소 클론 (또는 파일 다운로드)
git clone https://github.com/your-repo/accounting-system.git
cd accounting-system
```

### 엑셀 파일 생성

```bash
# Python 스크립트 실행
python business_accounting_system.py
```

### 실행 결과

```
================================================================================
전문 사업체 예산 관리 회계 시스템 생성 중...
================================================================================
[OK] 스타일 시스템 초기화 완료
[OK] 샘플 데이터 생성 중...
  - 매출 데이터: 1,110건
  - 비용 데이터: 648건

시트 생성 중...
  1. Settings 시트...
  2. Data_Entry 시트...
  3. Daily_Sales 시트...
  4. 사업체별 상세 시트...
  5. Revenue_Structure 시트...
  6. Expense_Management 시트...
  7. P&L 시트...
  8. Dashboard 시트...

파일 저장 중...

================================================================================
생성 완료!
================================================================================

[데이터 요약]
  - 총 매출: 2,025,950,000원
  - 총 비용: 1,156,020,000원
  - 순이익: 869,930,000원
  - 영업이익률: 42.94%
```

생성된 파일: `사업체_예산관리_회계시스템.xlsx`

---

## 시스템 구조

### 10개 시트 구성

| 시트명 | 용도 | 주요 기능 |
|--------|------|-----------|
| **Dashboard** | 통합 대시보드 | KPI 카드, 사업체별 성과, 차트 |
| **Data_Entry** | 데이터 입력 | 드롭다운, 유효성 검사, 샘플 데이터 |
| **Daily_Sales** | 일별 매출 기록 | 전체 거래, 필터, 합계 |
| **사업체_일해라컴퍼니** | 일해라컴퍼니 상세 | KPI, 매출/비용 분석, 차트 |
| **사업체_와작홈즈** | 와작홈즈 상세 | KPI, 매출/비용 분석, 차트 |
| **사업체_네안데르** | 네안데르 상세 | KPI, 매출/비용 분석, 차트 |
| **Revenue_Structure** | 매출 구조 분석 | 5개 매출 구조별 월별 분석 |
| **Expense_Management** | 비용 관리 | 카테고리별, 사업체별 비용 분석 |
| **P&L** | 손익계산서 | 월별/분기별 손익, 추이 차트 |
| **Settings** | 설정 | 사업체 정보, 매출 구조, 비용 카테고리 |

### 데이터 흐름

```
Data_Entry (입력)
    ↓
Daily_Sales (저장)
    ↓
┌───────────────┬────────────────┬───────────────┬──────────────┐
│               │                │               │              │
Dashboard   사업체 시트    Revenue_Structure  Expense_Mgmt
    ↓                                              ↓
  Charts                                         P&L
```

---

## 주요 기능

### 1. 통합 대시보드

**핵심 KPI**:
- 총 매출
- 총 비용
- 순이익
- 영업이익률

**분석 테이블**:
- 사업체별 성과 (매출, 비용, 이익, 이익률, 매출 비중, 거래 건수)
- 매출 구조별 성과 (금액, 비중, 건수, 평균 거래액)

**시각화**:
- 사업체별 매출/비용 비교 막대 차트
- 매출 구조별 분포 파이 차트

### 2. 데이터 입력

**입력 폼**:
- 날짜 (yyyy-mm-dd 형식)
- 사업체 (드롭다운)
- 매출 구조 (드롭다운)
- 금액 (유효성 검사: 0 이상)
- 고객명
- 상세설명

**유효성 검사**:
- 사업체: 3개 중 선택
- 매출 구조: 5개 중 선택
- 금액: 0 이상 정수만 입력

### 3. 일별 매출 조회

**필터 기능**:
- 날짜별 필터
- 사업체별 필터
- 매출 구조별 필터
- 고객별 필터

**자동 집계**:
- SUBTOTAL 함수로 필터링된 데이터 합계 자동 계산

### 4. 사업체별 상세 분석

각 사업체마다:
- **KPI**: 총 매출, 총 비용, 순이익
- **매출 구조별 분석**: 건수, 금액, 비율, 평균 거래액
- **비용 분석**: 카테고리별, 항목별 상세 내역
- **차트**: 매출 구조별 분포 파이 차트

### 5. 매출 구조 분석

5개 매출 구조:
1. 제품 판매
2. 서비스 제공
3. 구독/멤버십
4. 컨설팅
5. 프로젝트 수주

**월별 분석**:
- 날짜, 사업체 수, 고객 수, 금액, 누적 금액, 누적 건수, 평균 거래액

### 6. 비용 관리

**3개 카테고리**:
- 고정비: 임대료, 인건비, 통신비, 보험료, 감가상각비, 이자비용
- 변동비: 원재료비, 외주비, 운송비, 광고선전비, 접대비, 소모품비, 수수료
- 기타비용: 연구개발비, 교육훈련비, 복리후생비, 세금과공과, 잡비

**분석**:
- 카테고리별 요약
- 사업체별 비용 분석
- 비용 구조 차트

### 7. 손익계산서

**월별 손익**:
- 매출액
- 비용
- 영업이익
- 영업이익률
- 누적 이익

**분기별 요약**:
- Q1, Q2, Q3, Q4 분기별 집계

**시각화**:
- 월별 손익 추이 라인 차트 (매출, 비용, 이익)

---

## 사용 예시

### 새 매출 입력

1. **Data_Entry** 시트로 이동
2. 빈 행에 데이터 입력:
   ```
   날짜: 2025-01-15
   사업체: 일해라컴퍼니
   매출구조: 컨설팅
   금액: 3,000,000
   고객명: ABC기업
   설명: 경영 컨설팅 서비스
   ```
3. Enter 키 → 자동 저장

### 특정 기간 매출 조회

1. **Daily_Sales** 시트로 이동
2. 날짜 필터 클릭
3. "2025-01-01 ~ 2025-01-31" 선택
4. 확인 → 1월 매출만 조회

### 사업체별 성과 비교

1. **Dashboard** 시트 확인
2. "사업체별 성과" 테이블에서 비교
3. 차트로 시각적 비교

### 월별 손익 확인

1. **P&L** 시트로 이동
2. 월별 손익 계산서 테이블 확인
3. 차트로 추이 파악

---

## 고급 기능

### 피벗 테이블 생성

```
1. Daily_Sales 시트 데이터 선택
2. 삽입 → 피벗 테이블
3. 필드 배치:
   - 행: 사업체, 매출구조
   - 값: 금액 합계
```

### 슬라이서 추가

```
1. Daily_Sales 테이블 클릭
2. 테이블 도구 → 디자인 → 슬라이서 삽입
3. 사업체, 매출구조 선택
4. 슬라이서로 필터링
```

### VLOOKUP 활용

```excel
=VLOOKUP(B2, Settings!$A$4:$C$6, 3, FALSE)
```

### SUMIFS 활용

```excel
=SUMIFS(Daily_Sales!$E:$E, Daily_Sales!$B:$B, "일해라컴퍼니", Daily_Sales!$C:$C, "컨설팅")
```

---

## 커스터마이징

### 새 사업체 추가

1. `business_accounting_system.py` 열기
2. `COMPANIES` 리스트에 사업체 추가:
   ```python
   COMPANIES = ["일해라컴퍼니", "와작홈즈", "(주)네안데르", "새로운사업체"]
   ```
3. `COLORS`에 색상 추가:
   ```python
   'company4': '#70AD47'
   ```
4. 스크립트 재실행

### 새 매출 구조 추가

1. `REVENUE_TYPES` 리스트에 추가:
   ```python
   REVENUE_TYPES = [
       "제품 판매",
       "서비스 제공",
       "구독/멤버십",
       "컨설팅",
       "프로젝트 수주",
       "라이선스 판매"  # 추가
   ]
   ```
2. 금액 범위 설정:
   ```python
   amount_ranges = {
       ...
       "라이선스 판매": (100000, 2000000)
   }
   ```
3. 스크립트 재실행

### 새 비용 카테고리 추가

1. `EXPENSE_CATEGORIES`에 추가:
   ```python
   EXPENSE_CATEGORIES = {
       "고정비": [...],
       "변동비": [...],
       "기타비용": [...],
       "투자비": ["장비구입", "시설투자"]  # 추가
   }
   ```
2. 스크립트 재실행

---

## 문제 해결

### 자주 묻는 질문 (FAQ)

**Q1. 차트가 업데이트되지 않습니다.**
- F9 키로 수동 계산 실행
- 파일 → 옵션 → 수식 → 자동 계산 설정

**Q2. 필터가 작동하지 않습니다.**
- 데이터 → 필터 해제 후 재설정
- 빈 행/열 제거

**Q3. 드롭다운이 표시되지 않습니다.**
- 데이터 → 데이터 유효성 검사 확인
- 원본 범위 재설정

**Q4. 합계가 잘못 계산됩니다.**
- 수식 범위 확인
- 순환 참조 오류 검사
- SUBTOTAL 함수 사용 확인

**Q5. 파일이 느려졌습니다.**
- 불필요한 데이터 삭제
- 조건부 서식 최소화
- 자동 계산 → 수동 계산

---

## 성능

### 벤치마크

- **실행 시간**: ~10초
- **파일 크기**: ~150KB (샘플 데이터)
- **메모리 사용**: ~50MB (피크)

### 데이터 용량

- **1년 데이터**: ~500KB
- **3년 데이터**: ~1.5MB
- **10년 데이터**: ~5MB

---

## 기여

프로젝트에 기여하고 싶으시다면:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

---

## 라이선스

MIT License

Copyright (c) 2025

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

---

## 문서

- [사용자 가이드](사업체_회계시스템_사용가이드.md)
- [기술 문서](시스템_기술문서.md)

---

## 지원

기술 지원이 필요하시면:
- Issue 트래커: [GitHub Issues](https://github.com/your-repo/accounting-system/issues)
- 이메일: support@example.com

---

## 로드맵

### Version 1.1 (계획)
- [ ] 예산 대비 실적 분석
- [ ] 전년 대비 성장률 분석
- [ ] 월별 예측 기능

### Version 1.2 (계획)
- [ ] 세금 계산 기능
- [ ] 급여 관리 연동
- [ ] 데이터베이스 연동

### Version 2.0 (계획)
- [ ] 웹 대시보드
- [ ] 모바일 앱
- [ ] 실시간 협업

---

## 감사의 말

- xlsxwriter 라이브러리 개발팀
- Python 커뮤니티
- 모든 기여자분들

---

## 스크린샷

### 대시보드
```
[통합 경영 대시보드]
┌─────────────────────────────────────┐
│ 총 매출: 2,025,950,000원            │
│ 총 비용: 1,156,020,000원            │
│ 순이익: 869,930,000원               │
│ 영업이익률: 42.94%                  │
└─────────────────────────────────────┘

[사업체별 성과]
┌────────────────┬────────────┬──────────┐
│ 사업체          │ 매출액      │ 이익률   │
├────────────────┼────────────┼──────────┤
│ 일해라컴퍼니    │ 678M       │ 45.2%    │
│ 와작홈즈        │ 674M       │ 41.8%    │
│ (주)네안데르    │ 673M       │ 41.8%    │
└────────────────┴────────────┴──────────┘
```

### 차트
```
[사업체별 매출/비용 비교]
   매출 ■■■■■■■■■■
   비용 ■■■■■

[매출구조별 분포]
   제품판매 20% 🟦
   서비스 25% 🟩
   구독 15% 🟨
   컨설팅 30% 🟧
   프로젝트 10% 🟥
```

---

**최종 업데이트**: 2025년 1월
**버전**: 1.0
**개발**: AI 회계 시스템
